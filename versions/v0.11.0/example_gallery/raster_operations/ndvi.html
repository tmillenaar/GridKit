<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NDVI &mdash; GridKit v0.11.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="canonical" href="https://tmilenaar.github.io/GridKit/versions/v0.11.0/example_gallery/raster_operations/ndvi.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5899e6ac"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Partial overlap" href="parial_overlap.html" />
    <link rel="prev" title="Triangles in hexagons" href="../grid_definitions/triangles_in_hexes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GridKit
          </a>
              <div class="version">
                v0.11.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Example Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#cell-centric">Cell centric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#grid-definitions">Grid definitions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#raster-operations">Raster operations</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">NDVI</a></li>
<li class="toctree-l3"><a class="reference internal" href="parial_overlap.html">Partial overlap</a></li>
<li class="toctree-l3"><a class="reference internal" href="resampling.html">Resampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="coordinate_transformations.html">Coordinate transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="elevation_distribution_per_land_cover.html">Combining land cover and DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#vector-data-interactions">Vector data interactions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GridKit</a>
      </nav>

      <div class="wy-nav-content">
  
    <div style="
        background-color: #ffefc2;
        color: #333;
        padding: 1em;
        border-bottom: 2px solid #e6c200;
        font-weight: bold;
        text-align: center;
    ">
      You are viewing an <strong>outdated version</strong> of the documentation (v0.11.0).<br>
      Latest version: <a href="../../../v0.14.1/index.html">v0.14.1</a>
    </div>
  
  
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Example Gallery</a></li>
      <li class="breadcrumb-item active">NDVI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/example_gallery/raster_operations/ndvi.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-example-gallery-raster-operations-ndvi-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="ndvi">
<span id="example-ndvi"></span><span id="sphx-glr-example-gallery-raster-operations-ndvi-py"></span><h1>NDVI<a class="headerlink" href="#ndvi" title="Link to this heading"></a></h1>
<p>Operation using two raster bands</p>
<p>In this example we read two Sentinel 2 raster bands and combine them to calculate the Normalized Difference Vegetation Index (NDVI).
Since these bands are already from the same Sentinel 2 acquisition, they are already ‘aligned’.
This means none of the bands have to be resampled before we combine them.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If this example matches your use case, you may also be interested in the packages Rasterio or Rioxarray.
This example is created to get the reader familiar with the synax of GridKit and to highlight some of the intricacies when working with this package.</p>
</div>
<p>Also, a numpy warning is raised because we devide by zero for some cells.
These turn into NaN-values.
This is remedied in the script by replacing each NaN-value with 0 afterwards.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">gridkit</span> <span class="kn">import</span> <span class="n">read_raster</span>

<span class="c1"># Read in the bands required to determine the NDVI</span>
<span class="n">band_4</span> <span class="o">=</span> <span class="n">read_raster</span><span class="p">(</span><span class="s2">&quot;../../tests/data/20220708_S2_L2A_B04_raw.tiff&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">band_8</span> <span class="o">=</span> <span class="n">read_raster</span><span class="p">(</span><span class="s2">&quot;../../tests/data/20220708_S2_L2A_B08_raw.tiff&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The source data is defined in <cite>int16</cite>, which is consequently also the numpy dtype after reading.
The numbers that result from adding the two bands are too large to store in a dtype of <cite>int16</cite>.
Numpy does not upcast automatically, so we need to be aware of the dtypes ourselves.
In this case the dtype is increased to <cite>int32</cite>, by calling <code class="docutils literal notranslate"><span class="pre">astype</span></code> directly after reading.
If this is not done, the script will run, but the resulting values will be incorrect.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Determine the NDVI</span>
<span class="n">ndvi</span> <span class="o">=</span> <span class="p">(</span><span class="n">band_8</span> <span class="o">-</span> <span class="n">band_4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">band_8</span> <span class="o">+</span> <span class="n">band_4</span><span class="p">)</span>
<span class="n">ndvi</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">numpy</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">ndvi</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># fill NaN values resulting from a division by 0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If, for any cell, the denominator (band_8 + band_4) is zero, Numpy raises a warning.
The return value for these cells is a <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.
They will show as white in the image.
For a smoother looking visualization, these values are replaced with a zero in this example.
This decision is of course use case dependent.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the result</span>
<span class="n">mpl_extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">band_4</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">band_4</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">band_4</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">band_4</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">im_ndvi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ndvi</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">mpl_extent</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im_ndvi</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.022</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDVI of scene in the alps </span><span class="se">\n</span><span class="s2"> EPSG:</span><span class="si">{</span><span class="n">ndvi</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_ndvi_001.png" srcset="../../_images/sphx_glr_ndvi_001.png" alt="NDVI of scene in the alps   EPSG:3857" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 3.714 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-example-gallery-raster-operations-ndvi-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8f95a4d9d5c39fba50631182eb797488/ndvi.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">ndvi.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c92eff7c24f20f85c3b25f2e83eff1f1/ndvi.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">ndvi.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../grid_definitions/triangles_in_hexes.html" class="btn btn-neutral float-left" title="Triangles in hexagons" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parial_overlap.html" class="btn btn-neutral float-right" title="Partial overlap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Timo Millenaar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>

      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <style>
    .rst-other-versions li.current a {
      font-weight: bold;
      color: #007bff;
    }
  </style>
  <span class="rst-current-version" data-toggle="rst-current-version">
    Version: v0.11.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Versions</dt>
      
        <li >
          <a href="versions/dev//index.html">dev</a> 
        </li>
      
        <li >
          <a href="versions/v0.14.1//index.html">v0.14.1</a> 
        </li>
      
        <li >
          <a href="versions/v0.14.0//index.html">v0.14.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.13.0//index.html">v0.13.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.12.1//index.html">v0.12.1</a> 
        </li>
      
        <li >
          <a href="versions/v0.12.0//index.html">v0.12.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.11.1//index.html">v0.11.1</a> 
        </li>
      
        <li class="current">
          <a href="versions/v0.11.0//index.html">v0.11.0</a>   <--
        </li>
      
        <li >
          <a href="versions/v0.10.0//index.html">v0.10.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.9.2//index.html">v0.9.2</a> 
        </li>
      
        <li >
          <a href="versions/v0.9.1//index.html">v0.9.1</a> 
        </li>
      
        <li >
          <a href="versions/v0.9.0//index.html">v0.9.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.8.0//index.html">v0.8.0</a> 
        </li>
      
        <li >
          <a href="versions/v0.7.3//index.html">v0.7.3</a> 
        </li>
      
        <li >
          <a href="versions/v0.7.2//index.html">v0.7.2</a> 
        </li>
      
        <li >
          <a href="versions/v0.7.1//index.html">v0.7.1</a> 
        </li>
      
        <li >
          <a href="versions/v0.7.0//index.html">v0.7.0</a> 
        </li>
      
    </dl>
    
    <br>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>